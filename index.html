<!DOCTYPE html>
<html>
    <head>
        <title>Fees Calculator – The Learning Circle</title>
        <link rel="icon" href="https://thelearningcircle.co.uk/wp-content/uploads/2020/06/turquoise-circle-150x150.jpg" sizes="32x32">
        <meta charset="UTF-8">
        <style>
        body {
            font-family: sans-serif;
            margin: 0;
        }
        #header {
            padding: 10px;
            margin-top: 0px;
            margin-bottom: 5px;
            background-color: #4e9dbe;
        }
        #body {
            padding: 1%;
        }
        #input {
            padding: 8px;
            background-color: #80cff1;
            height: auto;
            width: 40%;
        }
        .RO {
            font-family: Impact;
            font-weight: normal;
            font-size: 13px;
            padding-right: 7px;
        }
        .text_field {
            width: 40px;
        }
        .text_input {
            height: 5;
            padding-top: 1px;
            padding-bottom: 1px;
        }
        #credit {
            margin-top: 5px;
            margin-bottom: 1px;
        }
        #OUTPUT {
            background-color: #badbed;
            width: 15%;
            margin-top: 2px;
            margin-bottom: 2px;
        }
        #button {
            padding: 10px;
            padding-left: 0px;
        }
        button {
            padding: 5px;
        }
        </style>
        <script>
            //create global variables
            let TLC,GCSE,TIER = 0;
            let TMP = false;
            const TLC_URL = "https://raw.githubusercontent.com/Opextwo/opextwo.github.io/experimental/tlc_fees.csv";
            const GCSE_URL = "https://raw.githubusercontent.com/Opextwo/opextwo.github.io/experimental/gcse_fees.csv";
            let TLC_PRICES,GCSE_PRICES;

            //add user input to global variables
            async function start(tlc, gcse, t1, t2, t3, tmp) {
                TLC = tlc;
                GCSSE = gcse;
                TMP = tmp;

                if (t1) {
                    TIER = 1;
                } else if (t2) {
                    TIER = 2;
                } else if (t3) {
                    TIER = 3;
                } else {
                    error("setting tier");
                }

                await fetch_csvs();

                calculate();
            }

            //calculate 
            function calculate() {
                //get a combind day count
                let combined_days = TLC + GCSE;
                //get both combind day and gcse prices using a function
                //minus the gcse from the tlc
                //send result to out put function
            }

            //out put function to keep stuff looking clean

            //error function to call if anything goes wrong 
            function error(process, endprogram) {
                console.log("an error occurd whilst: " + process)
            }

            //price getter function 
            
            //fetch csv data for both TLC & GCSE function
            async function fetch_csvs() {
                try {
                    const response = await fetch(TLC_URL);
                    if (!response.ok) throw new Error('Failed to fetch CSV data');
    
                    const csvData = await response.text();
                    TLC_PRICES = csvData.split('\n').flatMap(row => row.split(',')).filter(value => value.trim() !== '');
                } catch (error) {
                    error("fetching csv for TLC fees");
                }
                try {
                    const response = await fetch(GCSE_URL);
                    if (!response.ok) throw new Error('Failed to fetch CSV data');
    
                    const csvData = await response.text();
                    GCSE_PRICES = csvData.split('\n').flatMap(row => row.split(',')).filter(value => value.trim() !== '');
                } catch (error) {
                    error("fetching csv for GCSE fees");
                }
            }
        </script>
    </head>
    <body>
        <h2 id="header">Fees Calculator for the learning circle</h2>
        <div id="body">
        <div id="input">
            <div class="text_input">
            <label for="TLC_IN">Number of TLC days: </label>
            <input type="number" id="TLC_IN" class="text_field" value="0" min="0" max="4">
            </div>
            <br>
            <div class="text_input">
            <label for="TLC_IN">Number of IGCSEs: </label>
            <input type="number" id="GCSE_IN" class="text_field" value="0" min="0" max="7">
            </div>
            <br>
            <label>Income Tier: </label>
            <input type="radio" id="T1_IN" name="tier">
            <label for="T1_IN" class="RO">1</label>
            <input type="radio" id="T2_IN" name="tier" checked="true">
            <label for="T1_IN" class="RO">2</label>
            <input type="radio" id="T3_IN" name="tier">
            <label for="T1_IN" class="RO">3</label>
            <br>
            <label for="TMP_IN">Payments per year: </label>
            <input type="radio" id="TMP_F" name="TMP" checked="true">
            <Label for="TMP_F" class="RO">10</Label>
            <input type="radio" id="TMP_T" name="TMP">
            <label for="TMP_T" class="RO">12</label>
            <br>
            <div id="button">
            <button type="button" onclick="start(
                Number.parseFloat(document.getElementById('TLC_IN').value), 
                Number.parseFloat(document.getElementById('GCSE_IN').value),
                document.getElementById('T1_IN').checked, 
                document.getElementById('T2_IN').checked, 
                document.getElementById('T3_IN').checked,
                document.getElementById('TMP_T').checked
                )">Calculate!</button>
            </div>

            <p>Fees for extra TLC days (not includingGCSE fees): </p>
            <p id="OUTPUT">£0</p>
        </div>
        
        <h5 id="credit">Coded by Jessica King</h5>
        </div>
    </body>
</html>
